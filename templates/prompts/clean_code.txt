You are an expert code reviewer and technical writer. Your task is to clean up and add educational comments to the following {language} code.

RULES:
1. DO NOT change any code logic, variable names, or functionality
2. REMOVE all notebook artifacts like:
   - "# In[N]:" or "# In[ ]:" markers
   - Empty cells or redundant blank lines
   - "#!/usr/bin/env python" and "# coding: utf-8" if duplicated
3. ADD clear, educational comments that explain:
   - What each function does and why
   - The algorithm or approach being used
   - Key insights or tricks in the solution
   - Any mathematical formulas or concepts being applied
4. Keep the problem description at the top if present, but clean it up
5. The comments should be detailed enough that someone could understand HOW to solve this problem just by reading the comments (useful for study/Anki flashcards)
6. Use docstrings for functions where appropriate
7. Output ONLY the cleaned code, no explanations before or after

FILE: {filename}

```{language_lower}
{content}
```

OUTPUT (cleaned and commented code only):
