You are an expert digital signal processing instructor. Your task is to annotate the following {language} code to make it perfect for generating Anki flashcards.

CONTEXT: This code demonstrates DIGITAL SIGNAL PROCESSING concepts - likely FFT, DFT, convolution, correlation, filtering, or spectral analysis. It may be study material for a signals & systems or DSP course.

YOUR GOAL: Transform this into self-documenting study material where:
- Someone can understand WHAT DSP concept is being demonstrated
- They can learn the MATHEMATICAL foundation behind it
- The comments serve as flashcard-ready explanations
- The PROBLEM/PURPOSE is reconstructed if only code is given

ANNOTATION RULES:
1. DO NOT change any code logic - only add/improve comments
2. At the TOP, add a clear header comment block:
   - TOPIC: The DSP concept being demonstrated (e.g., "Cooley-Tukey FFT", "Cross-Correlation", "DFT Matrix")
   - PROBLEM: Reconstruct what this code is trying to achieve
   - KEY FORMULAS: List the mathematical formulas used (e.g., "X[k] = Σ x[n]·e^(-j2πkn/N)")
   - COMPLEXITY: Time and space complexity if applicable
3. Add inline comments explaining:
   - WHY specific operations are performed (mathematical reasoning)
   - WHAT each variable/array represents in DSP terms
   - HOW the algorithm relates to the mathematical definition
   - Any OPTIMIZATIONS (e.g., FFT vs naive DFT)
4. For each function, add a comment explaining:
   - Its PURPOSE and the transform/operation it computes
   - Input/output in signal processing terms
5. Explain NumPy/SciPy DSP functions when used (np.fft.fft, np.correlate, etc.)
6. Keep comments CONCISE but INFORMATIVE - they should work as flashcard answers
7. Use the native comment style for {language}

EXAMPLES OF GOOD ANNOTATIONS:
- "# DFT: X[k] = Σ x[n]·exp(-j2πkn/N) - transforms time domain to frequency domain"
- "# Twiddle factor: W_N^k = exp(-j2πk/N) - complex rotation in frequency domain"
- "# Correlation via FFT: corr(a,b) = IFFT(conj(FFT(a)) * FFT(b))"
- "# Divide-and-conquer: split into even/odd indices reduces O(N²) to O(N log N)"

FILE: {filename}

```{language_lower}
{content}
```

OUTPUT (annotated code only, ready for Anki flashcard generation):
