You are an expert digital signal processing and control systems instructor. Your task is to annotate the following {language} code to make it perfect for generating Anki flashcards.

CONTEXT: This code demonstrates DIGITAL SIGNAL PROCESSING or CONTROL SYSTEMS concepts. It may cover:
- DSP: FFT, DFT, convolution, correlation, filtering, spectral analysis
- Control Systems: transfer functions, PID controllers, Bode plots, stability margins, pole-zero analysis, step/impulse response, state-space models

The file may be exported from a Jupyter notebook, where markdown appears as comments (e.g., "# # Header" for H1, "# text" for paragraphs, "# $formula$" for LaTeX). Preserve this structure.

YOUR GOAL: Transform this into self-documenting study material where:
- Someone can understand WHAT DSP/Control concept is being demonstrated
- They can learn the MATHEMATICAL foundation behind it
- The comments serve as flashcard-ready explanations
- The PROBLEM/PURPOSE is reconstructed if only code is given
- ANY INCOMPLETE CODE (marked "YOUR CODE HERE") is completed correctly

ANNOTATION RULES:
1. COMPLETE any code sections marked with "YOUR CODE HERE" - fill in working solutions
2. At the TOP, add a clear header comment block:
   - TOPIC: The concept being demonstrated (e.g., "PI Controller for First-Order System", "Bode Stability Analysis", "Discrete-Time Simulation")
   - PROBLEM: Reconstruct what this code is trying to achieve
   - KEY FORMULAS: List the mathematical formulas used (e.g., "G(s) = K/(τs+1)", "Gm = 1/|L(jω_φ)|", "y[k+1] = y[k] + Ts·f(y[k])")
   - PHYSICAL SYSTEM: If applicable, describe the real-world system being modeled
3. Add inline comments explaining:
   - WHY specific operations are performed (mathematical reasoning)
   - WHAT each variable represents in DSP/Control terms
   - HOW the algorithm relates to the mathematical definition
   - CONTROL CONCEPTS: stability margins, damping ratio, time constants, etc.
4. For each function/section, add a comment explaining:
   - Its PURPOSE and the transform/operation it computes
   - Input/output in signal processing or control terms
5. Explain library functions when used:
   - NumPy/SciPy DSP: np.fft.fft, np.correlate, scipy.signal, etc.
   - Python-control: ctrl.TransferFunction, ctrl.bode, ctrl.feedback, ctrl.step_response, etc.
6. Keep comments CONCISE but INFORMATIVE - they should work as flashcard answers
7. Preserve any existing markdown-style comments from Jupyter notebooks (# # Header, # text)
8. Use the native comment style for {language}

EXAMPLES OF GOOD ANNOTATIONS:
- "# DFT: X[k] = Σ x[n]·exp(-j2πkn/N) - transforms time domain to frequency domain"
- "# Transfer function: G(s) = K/(τs+1) - first-order system with gain K and time constant τ"
- "# PI Controller: C(s) = Kp + Ki/s - proportional-integral control eliminates steady-state error"
- "# Euler discretization: y[k+1] = y[k] + Ts·dy/dt - converts continuous ODE to difference equation"
- "# Phase margin: φm = 180° + ∠L(jωc) - positive margin means stable closed-loop system"
- "# Closed-loop: T(s) = L(s)/(1+L(s)) - tracking transfer function from reference to output"

FILE: {filename}

```{language_lower}
{content}
```

OUTPUT (annotated code with completed solutions, ready for Anki flashcard generation):
